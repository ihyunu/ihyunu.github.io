---
layout: single
title:  "갑상선 질환 이진분류"
excerpt: "제1차 경진대회"
categories: 
- 프로젝트
tags:
- 프로젝트
- 데이터분석
- 경진대회
- 의료데이터분석

published: false
---
# 타겟 컬럼
- 0: 정상 환자
- 1: 갑상선 질환 환자


```python
train.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>나이</th>
      <th>성별</th>
      <th>티록신_복용_여부</th>
      <th>항갑상선제_복용_여부</th>
      <th>지병_여부</th>
      <th>임신_여부</th>
      <th>갑상선_수술_이력</th>
      <th>I131_치료_여부</th>
      <th>갑상선저하_인지_여부</th>
      <th>갑상선항진증_인지_여부</th>
      <th>리튬_치료_여부</th>
      <th>갑상선종_여부</th>
      <th>종양_여부</th>
      <th>TSH</th>
      <th>FreeT3</th>
      <th>FreeT4</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>train_0</td>
      <td>59.0</td>
      <td>남</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.77</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>train_1</td>
      <td>63.0</td>
      <td>남</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>33.0</td>
      <td>1.5</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>train_2</td>
      <td>65.0</td>
      <td>여</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>1.7</td>
      <td>2.3</td>
      <td>0.95</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>train_3</td>
      <td>33.0</td>
      <td>남</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>예</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>6.2</td>
      <td>NaN</td>
      <td>0.66</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>train_4</td>
      <td>64.0</td>
      <td>여</td>
      <td>예</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>아니오</td>
      <td>1.2</td>
      <td>NaN</td>
      <td>0.95</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
train.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 4223 entries, 0 to 4222
    Data columns (total 18 columns):
     #   Column        Non-Null Count  Dtype  
    ---  ------        --------------  -----  
     0   ID            4223 non-null   object 
     1   나이            4220 non-null   float64
     2   성별            4086 non-null   object 
     3   티록신_복용_여부     4223 non-null   object 
     4   항갑상선제_복용_여부   4223 non-null   object 
     5   지병_여부         4223 non-null   object 
     6   임신_여부         4223 non-null   object 
     7   갑상선_수술_이력     4223 non-null   object 
     8   I131_치료_여부    4223 non-null   object 
     9   갑상선저하_인지_여부   4223 non-null   object 
     10  갑상선항진증_인지_여부  4223 non-null   object 
     11  리튬_치료_여부      4223 non-null   object 
     12  갑상선종_여부       4223 non-null   object 
     13  종양_여부         4223 non-null   object 
     14  TSH           3832 non-null   float64
     15  FreeT3        2989 non-null   float64
     16  FreeT4        3854 non-null   float64
     17  target        4223 non-null   int64  
    dtypes: float64(4), int64(1), object(13)
    memory usage: 594.0+ KB


# 타겟값 확인
- 비율 확인하기


```python
train["target"].mean()
```




    0.11816244376035993



# 결측치 처리


```python
train.isnull().sum()
```




    ID                 0
    나이                 3
    성별               137
    티록신_복용_여부          0
    항갑상선제_복용_여부        0
    지병_여부              0
    임신_여부              0
    갑상선_수술_이력          0
    I131_치료_여부         0
    갑상선저하_인지_여부        0
    갑상선항진증_인지_여부       0
    리튬_치료_여부           0
    갑상선종_여부            0
    종양_여부              0
    TSH              391
    FreeT3          1234
    FreeT4           369
    target             0
    dtype: int64




```python
test.isnull().sum()
```




    ID                0
    나이                1
    성별              117
    티록신_복용_여부         0
    항갑상선제_복용_여부       0
    지병_여부             0
    임신_여부             0
    갑상선_수술_이력         0
    I131_치료_여부        0
    갑상선저하_인지_여부       0
    갑상선항진증_인지_여부      0
    리튬_치료_여부          0
    갑상선종_여부           0
    종양_여부             0
    TSH             333
    FreeT3          975
    FreeT4          312
    dtype: int64



- Data leakage를 피하기 위해 임의로 정한 상수 또는 학습데이터의 통계치를 이용하여 결측치를 처리해야 한다.


```python
fill_tsh = train["TSH"].mean()
fill_free_t3 = train["FreeT3"].mean()
fill_free_t4 = train["FreeT4"].mean()
```


```python
train["나이"] = train["나이"].fillna(0)
train["성별"] = train["성별"].fillna("UNK")
train["TSH"] = train["TSH"].fillna(fill_tsh)
train["FreeT3"] = train["FreeT3"].fillna(fill_free_t3)
train["FreeT4"] = train["FreeT4"].fillna(fill_free_t4)
```


```python
test["나이"] = test["나이"].fillna(0)
test["성별"] = test["성별"].fillna("UNK")
test["TSH"] = test["TSH"].fillna(fill_tsh)
test["FreeT3"] = test["FreeT3"].fillna(fill_free_t3)
test["FreeT4"] = test["FreeT4"].fillna(fill_free_t4)
```


```python
train.isnull().sum().sum() , test.isnull().sum().sum()
```




    (0, 0)




```python
train.columns
```




    Index(['ID', '나이', '성별', '티록신_복용_여부', '항갑상선제_복용_여부', '지병_여부', '임신_여부',
           '갑상선_수술_이력', 'I131_치료_여부', '갑상선저하_인지_여부', '갑상선항진증_인지_여부', '리튬_치료_여부',
           '갑상선종_여부', '종양_여부', 'TSH', 'FreeT3', 'FreeT4', 'target'],
          dtype='object')



# 특성 공학(Feature Engineering)
- Feature Engineering 과정에서 평가를 위한 예측을 해야하기 때문에 테스트 세트에 대해서도 동일한 작업을 진행해줘야 한다.


## "예" 또는 "아니오" 값만 갖고 있는 컬럼들 이진변수로 변경
- 두개의 값들만 존재하는 범주형 변수에 경우 원핫 인코딩처리할 경우 불필요한 피처가 추가된다.
- 예를 1로, 아니오를 0으로 변경 처리


```python
cols = [ col for col in train.columns if col.endswith("여부") or col.endswith("이력") ]
cols
```




    ['티록신_복용_여부',
     '항갑상선제_복용_여부',
     '지병_여부',
     '임신_여부',
     '갑상선_수술_이력',
     'I131_치료_여부',
     '갑상선저하_인지_여부',
     '갑상선항진증_인지_여부',
     '리튬_치료_여부',
     '갑상선종_여부',
     '종양_여부']




```python
train[cols] = (train[cols] == "예").astype(int)
test[cols] = (test[cols] == "예").astype(int)
```


```python
train.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>나이</th>
      <th>성별</th>
      <th>티록신_복용_여부</th>
      <th>항갑상선제_복용_여부</th>
      <th>지병_여부</th>
      <th>임신_여부</th>
      <th>갑상선_수술_이력</th>
      <th>I131_치료_여부</th>
      <th>갑상선저하_인지_여부</th>
      <th>갑상선항진증_인지_여부</th>
      <th>리튬_치료_여부</th>
      <th>갑상선종_여부</th>
      <th>종양_여부</th>
      <th>TSH</th>
      <th>FreeT3</th>
      <th>FreeT4</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>train_0</td>
      <td>59.0</td>
      <td>남</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4.953486</td>
      <td>2.021445</td>
      <td>0.770000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>train_1</td>
      <td>63.0</td>
      <td>남</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>33.000000</td>
      <td>1.500000</td>
      <td>0.965153</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>train_2</td>
      <td>65.0</td>
      <td>여</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.700000</td>
      <td>2.300000</td>
      <td>0.950000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>train_3</td>
      <td>33.0</td>
      <td>남</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6.200000</td>
      <td>2.021445</td>
      <td>0.660000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>train_4</td>
      <td>64.0</td>
      <td>여</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.200000</td>
      <td>2.021445</td>
      <td>0.950000</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>



## Feature Extraction

- 특성으로 사용할 변수 추가하기
- 기존 피쳐와 더해 추가적으로 상관관계가 클 것 같은 피쳐도 조합해서 피쳐를 생성한다.


```python
train_ft = train.iloc[:,1:-1].copy() # ID 컬럼 및 정답 컬럼 제외
test_ft = test.iloc[:,1:].copy() # ID 컬럼 제외
train_ft.shape, test_ft.shape
```




    ((4223, 16), (3456, 16))




```python
train_ft.columns
```




    Index(['나이', '성별', '티록신_복용_여부', '항갑상선제_복용_여부', '지병_여부', '임신_여부', '갑상선_수술_이력',
           'I131_치료_여부', '갑상선저하_인지_여부', '갑상선항진증_인지_여부', '리튬_치료_여부', '갑상선종_여부',
           '종양_여부', 'TSH', 'FreeT3', 'FreeT4'],
          dtype='object')



### 여부 및 이력 관련 컬럼들의 예(1)의 합계를 피처로 추가


```python
train_ft
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>나이</th>
      <th>성별</th>
      <th>티록신_복용_여부</th>
      <th>항갑상선제_복용_여부</th>
      <th>지병_여부</th>
      <th>임신_여부</th>
      <th>갑상선_수술_이력</th>
      <th>I131_치료_여부</th>
      <th>갑상선저하_인지_여부</th>
      <th>갑상선항진증_인지_여부</th>
      <th>리튬_치료_여부</th>
      <th>갑상선종_여부</th>
      <th>종양_여부</th>
      <th>TSH</th>
      <th>FreeT3</th>
      <th>FreeT4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>59.0</td>
      <td>남</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4.953486</td>
      <td>2.021445</td>
      <td>0.770000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>63.0</td>
      <td>남</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>33.000000</td>
      <td>1.500000</td>
      <td>0.965153</td>
    </tr>
    <tr>
      <th>2</th>
      <td>65.0</td>
      <td>여</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.700000</td>
      <td>2.300000</td>
      <td>0.950000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>33.0</td>
      <td>남</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6.200000</td>
      <td>2.021445</td>
      <td>0.660000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>64.0</td>
      <td>여</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.200000</td>
      <td>2.021445</td>
      <td>0.950000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4218</th>
      <td>74.0</td>
      <td>남</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2.700000</td>
      <td>1.700000</td>
      <td>1.110000</td>
    </tr>
    <tr>
      <th>4219</th>
      <td>38.0</td>
      <td>남</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2.000000</td>
      <td>2.600000</td>
      <td>0.850000</td>
    </tr>
    <tr>
      <th>4220</th>
      <td>44.0</td>
      <td>여</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.300000</td>
      <td>1.500000</td>
      <td>1.070000</td>
    </tr>
    <tr>
      <th>4221</th>
      <td>73.0</td>
      <td>남</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3.900000</td>
      <td>1.900000</td>
      <td>0.800000</td>
    </tr>
    <tr>
      <th>4222</th>
      <td>73.0</td>
      <td>남</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.350000</td>
      <td>1.600000</td>
      <td>1.110000</td>
    </tr>
  </tbody>
</table>
<p>4223 rows × 16 columns</p>
</div>




```python
cols = [ col for col in train_ft.columns if col.endswith("여부") or col.endswith("이력") ]
train_ft["yes_sum"] = train_ft[cols].sum(axis=1)
test_ft["yes_sum"] = test_ft[cols].sum(axis=1)
```

### 여부 및 이력 관련 2개의 컬럼 조합의 예(1)의 합계를 피처로 추가


```python
cols
```




    ['티록신_복용_여부',
     '항갑상선제_복용_여부',
     '지병_여부',
     '임신_여부',
     '갑상선_수술_이력',
     'I131_치료_여부',
     '갑상선저하_인지_여부',
     '갑상선항진증_인지_여부',
     '리튬_치료_여부',
     '갑상선종_여부',
     '종양_여부']




```python
from itertools import combinations
for comb_cols in combinations(cols, 2):
    comb_cols = list(comb_cols)
    train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
```

### 여부 및 이력 관련 3개의 컬럼 조합의 예(1)의 합계를 피처로 추가


```python
for comb_cols in combinations(cols, 3):
    comb_cols = list(comb_cols)
    train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
```

    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:3: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["_".join(comb_cols)] = train_ft[comb_cols].sum(axis=1)
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/1298066710.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["_".join(comb_cols)] = test_ft[comb_cols].sum(axis=1)


### FreeT4 / FreeT3 비를 피처로 추가


```python
train_ft["FreeT4_FreeT3"] =  train_ft["FreeT4"] / train_ft["FreeT3"]
test_ft["FreeT4_FreeT3"] =   test_ft["FreeT4"] / test_ft["FreeT3"]
```

    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/485672834.py:1: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      train_ft["FreeT4_FreeT3"] =  train_ft["FreeT4"] / train_ft["FreeT3"]
    /var/folders/h_/9zygn2h102q97wfc4csmgl0r0000gn/T/ipykernel_35435/485672834.py:2: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      test_ft["FreeT4_FreeT3"] =   test_ft["FreeT4"] / test_ft["FreeT3"]


## Feature Encoding

- One-Hot Encoding


```python
from sklearn.preprocessing import OneHotEncoder
cols = train_ft.select_dtypes("object").columns.tolist()
enc = OneHotEncoder(handle_unknown = 'ignore')
cols
```




    ['성별']




```python
# 학습데이터
tmp = pd.DataFrame(
    enc.fit_transform(train_ft[cols]).toarray(),
    columns = enc.get_feature_names_out()
)
train_ft = pd.concat([train_ft,tmp],axis=1).drop(columns=cols) # 범주형 컬럼 제거
train_ft.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>나이</th>
      <th>티록신_복용_여부</th>
      <th>항갑상선제_복용_여부</th>
      <th>지병_여부</th>
      <th>임신_여부</th>
      <th>갑상선_수술_이력</th>
      <th>I131_치료_여부</th>
      <th>갑상선저하_인지_여부</th>
      <th>갑상선항진증_인지_여부</th>
      <th>리튬_치료_여부</th>
      <th>...</th>
      <th>갑상선저하_인지_여부_리튬_치료_여부_종양_여부</th>
      <th>갑상선저하_인지_여부_갑상선종_여부_종양_여부</th>
      <th>갑상선항진증_인지_여부_리튬_치료_여부_갑상선종_여부</th>
      <th>갑상선항진증_인지_여부_리튬_치료_여부_종양_여부</th>
      <th>갑상선항진증_인지_여부_갑상선종_여부_종양_여부</th>
      <th>리튬_치료_여부_갑상선종_여부_종양_여부</th>
      <th>FreeT4_FreeT3</th>
      <th>성별_UNK</th>
      <th>성별_남</th>
      <th>성별_여</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>59.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.380916</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>63.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.643435</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>65.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.413043</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>33.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.326499</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>64.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.469961</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 240 columns</p>
</div>




```python
# 테스트데이터
tmp = pd.DataFrame(
    enc.transform(test_ft[cols]).toarray(), # 테스트데이터는 transform 만 해야한다.
    columns = enc.get_feature_names_out()
)
test_ft = pd.concat([test_ft,tmp],axis=1).drop(columns=cols) # 범주형 컬럼 제거
test_ft.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>나이</th>
      <th>티록신_복용_여부</th>
      <th>항갑상선제_복용_여부</th>
      <th>지병_여부</th>
      <th>임신_여부</th>
      <th>갑상선_수술_이력</th>
      <th>I131_치료_여부</th>
      <th>갑상선저하_인지_여부</th>
      <th>갑상선항진증_인지_여부</th>
      <th>리튬_치료_여부</th>
      <th>...</th>
      <th>갑상선저하_인지_여부_리튬_치료_여부_종양_여부</th>
      <th>갑상선저하_인지_여부_갑상선종_여부_종양_여부</th>
      <th>갑상선항진증_인지_여부_리튬_치료_여부_갑상선종_여부</th>
      <th>갑상선항진증_인지_여부_리튬_치료_여부_종양_여부</th>
      <th>갑상선항진증_인지_여부_갑상선종_여부_종양_여부</th>
      <th>리튬_치료_여부_갑상선종_여부_종양_여부</th>
      <th>FreeT4_FreeT3</th>
      <th>성별_UNK</th>
      <th>성별_남</th>
      <th>성별_여</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>37.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.410597</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>55.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.480000</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>71.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.510526</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.479855</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.524377</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 240 columns</p>
</div>



## Feature Scaling
- Min-Max Scaling
    - 데이터 수치의 범위를 바꿔주는 정규화 스케일링 기법
    - 데이터 수치의 범위를 0 ~ 1 사이로 바꿔준다.


```python
from sklearn.preprocessing import MinMaxScaler, StandardScaler, RobustScaler, PowerTransformer
scaler = MinMaxScaler()
```


```python
# 학습데이터
train_ft[train_ft.columns] = scaler.fit_transform(train_ft)
train_ft.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>나이</th>
      <th>티록신_복용_여부</th>
      <th>항갑상선제_복용_여부</th>
      <th>지병_여부</th>
      <th>임신_여부</th>
      <th>갑상선_수술_이력</th>
      <th>I131_치료_여부</th>
      <th>갑상선저하_인지_여부</th>
      <th>갑상선항진증_인지_여부</th>
      <th>리튬_치료_여부</th>
      <th>...</th>
      <th>갑상선저하_인지_여부_리튬_치료_여부_종양_여부</th>
      <th>갑상선저하_인지_여부_갑상선종_여부_종양_여부</th>
      <th>갑상선항진증_인지_여부_리튬_치료_여부_갑상선종_여부</th>
      <th>갑상선항진증_인지_여부_리튬_치료_여부_종양_여부</th>
      <th>갑상선항진증_인지_여부_갑상선종_여부_종양_여부</th>
      <th>리튬_치료_여부_갑상선종_여부_종양_여부</th>
      <th>FreeT4_FreeT3</th>
      <th>성별_UNK</th>
      <th>성별_남</th>
      <th>성별_여</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.608247</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.013551</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.649485</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.023902</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.670103</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.014818</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.340206</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.011406</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.659794</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.017062</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 240 columns</p>
</div>




```python
# 테스트 데이터
test_ft[test_ft.columns] = scaler.transform(test_ft)  # 테스트데이터는 transform 만 해야한다.
test_ft.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>나이</th>
      <th>티록신_복용_여부</th>
      <th>항갑상선제_복용_여부</th>
      <th>지병_여부</th>
      <th>임신_여부</th>
      <th>갑상선_수술_이력</th>
      <th>I131_치료_여부</th>
      <th>갑상선저하_인지_여부</th>
      <th>갑상선항진증_인지_여부</th>
      <th>리튬_치료_여부</th>
      <th>...</th>
      <th>갑상선저하_인지_여부_리튬_치료_여부_종양_여부</th>
      <th>갑상선저하_인지_여부_갑상선종_여부_종양_여부</th>
      <th>갑상선항진증_인지_여부_리튬_치료_여부_갑상선종_여부</th>
      <th>갑상선항진증_인지_여부_리튬_치료_여부_종양_여부</th>
      <th>갑상선항진증_인지_여부_갑상선종_여부_종양_여부</th>
      <th>리튬_치료_여부_갑상선종_여부_종양_여부</th>
      <th>FreeT4_FreeT3</th>
      <th>성별_UNK</th>
      <th>성별_남</th>
      <th>성별_여</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.381443</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.014721</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.567010</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.017458</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.731959</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.018661</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.360825</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.017452</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.164948</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.019207</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 240 columns</p>
</div>



- 정답 데이터


```python
target = train["target"]
target
```




    0       0
    1       1
    2       0
    3       0
    4       0
           ..
    4218    0
    4219    0
    4220    0
    4221    0
    4222    0
    Name: target, Length: 4223, dtype: int64




```python
from sklearn.model_selection import cross_val_score
from sklearn.model_selection import StratifiedKFold
cv = StratifiedKFold(n_splits=5,shuffle=True, random_state=SEED)
```

## Feature Selection
- SelectPercentile 활용하여 가장 유의한 통계적 관계가 있는 피쳐를 퍼센트 별(5% ~ 95%)로 선택하여 cv 성능을 측정해서 최적의 피쳐 개수를 찾아보기



```python
!pip install catboost
```

    Requirement already satisfied: catboost in /opt/anaconda3/lib/python3.12/site-packages (1.2.5)
    Requirement already satisfied: graphviz in /opt/anaconda3/lib/python3.12/site-packages (from catboost) (0.20.3)
    Requirement already satisfied: matplotlib in /opt/anaconda3/lib/python3.12/site-packages (from catboost) (3.8.4)
    Requirement already satisfied: numpy>=1.16.0 in /opt/anaconda3/lib/python3.12/site-packages (from catboost) (1.26.4)
    Requirement already satisfied: pandas>=0.24 in /opt/anaconda3/lib/python3.12/site-packages (from catboost) (2.2.2)
    Requirement already satisfied: scipy in /opt/anaconda3/lib/python3.12/site-packages (from catboost) (1.13.1)
    Requirement already satisfied: plotly in /opt/anaconda3/lib/python3.12/site-packages (from catboost) (5.22.0)
    Requirement already satisfied: six in /opt/anaconda3/lib/python3.12/site-packages (from catboost) (1.16.0)
    Requirement already satisfied: python-dateutil>=2.8.2 in /opt/anaconda3/lib/python3.12/site-packages (from pandas>=0.24->catboost) (2.9.0.post0)
    Requirement already satisfied: pytz>=2020.1 in /opt/anaconda3/lib/python3.12/site-packages (from pandas>=0.24->catboost) (2024.1)
    Requirement already satisfied: tzdata>=2022.7 in /opt/anaconda3/lib/python3.12/site-packages (from pandas>=0.24->catboost) (2023.3)
    Requirement already satisfied: contourpy>=1.0.1 in /opt/anaconda3/lib/python3.12/site-packages (from matplotlib->catboost) (1.2.0)
    Requirement already satisfied: cycler>=0.10 in /opt/anaconda3/lib/python3.12/site-packages (from matplotlib->catboost) (0.11.0)
    Requirement already satisfied: fonttools>=4.22.0 in /opt/anaconda3/lib/python3.12/site-packages (from matplotlib->catboost) (4.51.0)
    Requirement already satisfied: kiwisolver>=1.3.1 in /opt/anaconda3/lib/python3.12/site-packages (from matplotlib->catboost) (1.4.4)
    Requirement already satisfied: packaging>=20.0 in /opt/anaconda3/lib/python3.12/site-packages (from matplotlib->catboost) (23.2)
    Requirement already satisfied: pillow>=8 in /opt/anaconda3/lib/python3.12/site-packages (from matplotlib->catboost) (10.3.0)
    Requirement already satisfied: pyparsing>=2.3.1 in /opt/anaconda3/lib/python3.12/site-packages (from matplotlib->catboost) (3.0.9)
    Requirement already satisfied: tenacity>=6.2.0 in /opt/anaconda3/lib/python3.12/site-packages (from plotly->catboost) (8.2.2)



```python
from sklearn.ensemble import RandomForestClassifier, BaggingClassifier
from sklearn.ensemble import AdaBoostClassifier
from sklearn.ensemble import GradientBoostingClassifier
from xgboost import XGBClassifier
from lightgbm import LGBMClassifier
from catboost import CatBoostClassifier
from sklearn.ensemble import VotingClassifier
from tqdm.auto import tqdm
from sklearn.feature_selection import SelectPercentile
cv_scores = [] # 퍼센트값과 CV 검증점수 담을 리스트
for p in tqdm(range(5,96,1)): # 5% ~ 95%
    select = SelectPercentile(percentile=p)
    select.fit(train_ft,target)
    # 별칭과 모델 객체를 튜플에 담아서 리스트에 넣음
estimators = [
    ('rf', RandomForestClassifier(random_state=SEED,n_estimators=500)),
    ('gb', GradientBoostingClassifier(random_state=SEED)),
    ('ada', AdaBoostClassifier(random_state=SEED)),
    ('bag', BaggingClassifier(random_state=SEED)),
    ('xgb', XGBClassifier(random_state=SEED)),
    ('lgbm', LGBMClassifier(random_state=SEED)),
    ('cat', CatBoostClassifier(verbose=0,random_state=SEED))
]

params_voting ={
    "estimators" : estimators, # 모델 담은 리스트 전달
    "voting" : "soft" , # soft 또는 hard 전달하여 cv 점수 확인해보기
    "n_jobs" : -1
}

model = VotingClassifier(**params_voting)
scores = cross_val_score(model, select.transform(train_ft), target, cv = cv, scoring='f1', n_jobs = -1)
cv_scores.append( [p,scores.mean()] ) # 퍼센트값과 CV 검증점수를 튜플에 담아 append

cv_scores = np.array(cv_scores) # ndarray로 변환
idx = np.argmax(cv_scores[:,1]) # CV 검증점수의 가장높은 점수 인덱스 반환
best_score = cv_scores[idx] # 가장높은 점수 인덱스의 퍼센트값과 CV 검증점수
best_score
```


      0%|          | 0/91 [00:00<?, ?it/s]


    /opt/anaconda3/lib/python3.12/site-packages/sklearn/ensemble/_weight_boosting.py:519: FutureWarning: The SAMME.R algorithm (the default) is deprecated and will be removed in 1.6. Use the SAMME algorithm to circumvent this warning.
      warnings.warn(
    /opt/anaconda3/lib/python3.12/site-packages/sklearn/ensemble/_weight_boosting.py:519: FutureWarning: The SAMME.R algorithm (the default) is deprecated and will be removed in 1.6. Use the SAMME algorithm to circumvent this warning.
      warnings.warn(
    /opt/anaconda3/lib/python3.12/site-packages/sklearn/ensemble/_weight_boosting.py:519: FutureWarning: The SAMME.R algorithm (the default) is deprecated and will be removed in 1.6. Use the SAMME algorithm to circumvent this warning.
      warnings.warn(
    /opt/anaconda3/lib/python3.12/site-packages/sklearn/ensemble/_weight_boosting.py:519: FutureWarning: The SAMME.R algorithm (the default) is deprecated and will be removed in 1.6. Use the SAMME algorithm to circumvent this warning.
      warnings.warn(


    [LightGBM] [Info] Number of positive: 399, number of negative: 2979
    [LightGBM] [Info] Number of positive: 400, number of negative: 2979
    [LightGBM] [Info] Number of positive: 399, number of negative: 2980
    [LightGBM] [Info] Number of positive: 399, number of negative: 2979
    [LightGBM] [Info] Auto-choosing row-wise multi-threading, the overhead of testing was 0.030595 seconds.
    You can set `force_row_wise=true` to remove the overhead.
    And if memory is not enough, you can set `force_col_wise=true`.
    [LightGBM] [Info] Total Bins 1363
    [LightGBM] [Info] Number of data points in the train set: 3378, number of used features: 227
    [LightGBM] [Info] [binary:BoostFromScore]: pavg=0.118117 -> initscore=-2.010382
    [LightGBM] [Info] Start training from score -2.010382
    [LightGBM] [Info] Auto-choosing row-wise multi-threading, the overhead of testing was 0.069078 seconds.
    You can set `force_row_wise=true` to remove the overhead.
    And if memory is not enough, you can set `force_col_wise=true`.
    [LightGBM] [Info] Total Bins 1369
    [LightGBM] [Info] Number of data points in the train set: 3379, number of used features: 227
    [LightGBM] [Info] [binary:BoostFromScore]: pavg=0.118378 -> initscore=-2.007878
    [LightGBM] [Info] Start training from score -2.007878
    [LightGBM] [Info] Auto-choosing row-wise multi-threading, the overhead of testing was 0.071228 seconds.
    You can set `force_row_wise=true` to remove the overhead.
    And if memory is not enough, you can set `force_col_wise=true`.
    [LightGBM] [Info] Total Bins 1357
    [LightGBM] [Info] Number of data points in the train set: 3379, number of used features: 227
    [LightGBM] [Info] Auto-choosing row-wise multi-threading, the overhead of testing was 0.063802 seconds.
    You can set `force_row_wise=true` to remove the overhead.
    And if memory is not enough, you can set `force_col_wise=true`.
    [LightGBM] [Info] Total Bins 1357
    [LightGBM] [Info] Number of data points in the train set: 3378, number of used features: 227
    [LightGBM] [Info] [binary:BoostFromScore]: pavg=0.118082 -> initscore=-2.010717
    [LightGBM] [Info] [binary:BoostFromScore]: pavg=0.118117 -> initscore=-2.010382
    [LightGBM] [Info] Start training from score -2.010382
    [LightGBM] [Info] Start training from score -2.010717


    /opt/anaconda3/lib/python3.12/site-packages/sklearn/ensemble/_weight_boosting.py:519: FutureWarning: The SAMME.R algorithm (the default) is deprecated and will be removed in 1.6. Use the SAMME algorithm to circumvent this warning.
      warnings.warn(


    [LightGBM] [Info] Number of positive: 399, number of negative: 2979
    [LightGBM] [Info] Auto-choosing row-wise multi-threading, the overhead of testing was 0.021374 seconds.
    You can set `force_row_wise=true` to remove the overhead.
    And if memory is not enough, you can set `force_col_wise=true`.
    [LightGBM] [Info] Total Bins 1367
    [LightGBM] [Info] Number of data points in the train set: 3378, number of used features: 228
    [LightGBM] [Info] [binary:BoostFromScore]: pavg=0.118117 -> initscore=-2.010382
    [LightGBM] [Info] Start training from score -2.010382





    array([95.        ,  0.87571541])



- 최고 CV 점수의 퍼센트 값으로 피처 선택하기


```python
select = SelectPercentile(percentile=best_score[0])
select.fit(train_ft,target)
best_cols = select.get_feature_names_out()
train_ft = train_ft[best_cols]
test_ft = test_ft[best_cols]
```

# 모델 학습및 교차 검증
- 단일 모델에 대한 K-Fold 앙상블
- cv 개수 만큼 모델을 만들어 산술평균 하는 방법


```python
from sklearn.model_selection import StratifiedKFold
from sklearn.metrics import f1_score
cv = StratifiedKFold(n_splits=5,shuffle=True, random_state=SEED)
model_list = [] # 폴드별 학습된 모델 담을 리스트
score_list = [] # 폴드별 검증 점수 담을 리스트
for tri,vai in cv.split(train_ft,target):
    # 학습
    x_train = train_ft.iloc[tri]
    y_train = target.iloc[tri]

    # 검증
    x_valid = train_ft.iloc[vai]
    y_valid = target.iloc[vai]
# 별칭과 모델 객체를 튜플에 담아서 리스트에 넣음
estimators = [
    ('rf', RandomForestClassifier(random_state=SEED,n_estimators=500)),
    ('gb', GradientBoostingClassifier(random_state=SEED)),
    ('ada', AdaBoostClassifier(random_state=SEED)),
    ('bag', BaggingClassifier(random_state=SEED)),
    ('xgb', XGBClassifier(random_state=SEED)),
    ('lgbm', LGBMClassifier(random_state=SEED)),
    ('cat', CatBoostClassifier(verbose=0, random_state=SEED))
]
# VotingClassifier 전달할 아규먼트
params_voting ={
    "estimators" : estimators, # 모델 담은 리스트 전달
    "voting" : "soft" , # soft 또는 hard 전달하여 cv 점수 확인해보기
    "n_jobs" : -1
}

model = VotingClassifier(**params_voting)
model.fit(x_train, y_train)


pred = model.predict(x_valid) # f1 점수 확인하기 위해 예측
score = f1_score(y_valid,pred) # 검증셋 f1 점수
score_list.append(score) # 폴드별 검증점수 저장
model_list.append(model) # 폴드별 학습된 모델 저장
```

    /opt/anaconda3/lib/python3.12/site-packages/sklearn/ensemble/_weight_boosting.py:519: FutureWarning: The SAMME.R algorithm (the default) is deprecated and will be removed in 1.6. Use the SAMME algorithm to circumvent this warning.
      warnings.warn(



```python
print(score_list)
np.mean(score_list) # 검증점수 평균
```

    [0.8775510204081632]





    0.8775510204081632



# 테스트 데이터 예측



```python
pred_list = [] # fold 별 학습된 모델의 테스트 데에터에 대한 예측을 담을 리스트
for model in model_list:
    pred = model.predict_proba(test_ft)[:,1] # 1에 대한 확률을 저장하여 soft voting을 한다.
    pred_list.append(pred)
```


```python
pred_list
```




    [array([0.07636153, 0.09289493, 0.0916896 , ..., 0.76074058, 0.06830362,
            0.07938689])]




```python
pred = np.mean(pred_list,axis=0) # 산술평균
pred
```




    array([0.07636153, 0.09289493, 0.0916896 , ..., 0.76074058, 0.06830362,
           0.07938689])




```python
pred = (pred > 0.5).astype(int) # 0 또는 1 값으로 변경
pred
```




    array([0, 0, 0, ..., 1, 0, 0])


